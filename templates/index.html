<!DOCTYPE html>
<html>
<head>
    <title>Notion Chart Generator</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <div style="max-width: 800px; margin: 0 auto; padding: 20px;">
        <h1>Notion Chart Generator</h1>
        <div style="margin-bottom: 20px;">
            <input type="text" id="databaseId" placeholder="Enter Notion Database ID" style="width: 100%; padding: 10px; margin-bottom: 10px;">
            <button onclick="generateChart()" style="padding: 10px 20px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">
                Generate Chart
            </button>
        </div>
        
        <div id="chartContainer" style="display: none; margin-top: 20px;">
            <h2>Generated Chart</h2>
            <div id="chart"></div>
            <div id="embedCode" style="margin-top: 20px;">
                <h3>Embed Code for Notion</h3>
                <textarea id="embedTextarea" rows="3" style="width: 100%; padding: 10px; margin-top: 10px;" readonly></textarea>
            </div>
        </div>
    </div>

    <script>
        async function generateChart() {
            const databaseId = document.getElementById('databaseId').value;
            if (!databaseId) {
                alert('Please enter a Notion Database ID');
                return;
            }

            try {
                const response = await fetch('/generate_chart', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ database_id: databaseId }),
                });

                const data = await response.json();
                if (data.success) {
                    document.getElementById('chartContainer').style.display = 'block';
                    Plotly.newPlot('chart', JSON.parse(data.chart));
                    document.getElementById('embedTextarea').value = data.embed_code;
                } else {
                    alert('Error generating chart: ' + data.error);
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }
    </script>
</body>
</html>
